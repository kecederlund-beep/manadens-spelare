<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="supabase-url" content="https://bupgsvxggtftbmjholpp.supabase.co" />
    <meta name="supabase-anon-key" content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ1cGdzdnhnZ3RmdGJtamhvbHBwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE5NDM1NDQsImV4cCI6MjA4NzUxOTU0NH0.LmlIE4EJqKFG-WFE8urkX2jR6NKealyvnCOjWG7Qo08" />

    <title>Månadens Spelare – SHL & SDHL</title>
    <meta
      name="description"
      content="Rösta på Månadens Spelare i SHL och SDHL. Välj din favorit, fyll i dina uppgifter och skicka in din röst."
    />
    <link rel="preconnect" href="https://res.cloudinary.com" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <a class="skip" href="#main">Hoppa till innehåll</a>

    <header class="top container" role="banner">
      <img
        class="banner"
        alt="Månadens Spelare"
        src="https://res.cloudinary.com/dufekxhkq/image/upload/v1758878747/banner_omro%CC%88stning_vit_tmguie.png"
      />
      <h1 class="welcome-headline" id="welcome-headline">
        MÅNADENS SPELARE PRESENTERAS AV
      </h1>
      <div class="sponsor">
        <a class="sponsor-logo" href="#" target="_blank" rel="noopener">
          <img alt="Sponsor" src="" />
        </a>
      </div>
    </header>

    <main id="main" class="container">
      <section class="auth-banner" id="auth-banner" hidden>
        <p id="auth-banner-text">Logga in med e-post för att rösta.</p>
        <button class="ghost" id="open-login" type="button">Logga in</button>
      </section>

      <section class="voting-closed" id="voting-closed" hidden>
        <p>Omröstningen är stängd.</p>
      </section>

      <section
        class="vote"
        aria-labelledby="sdhl-title"
        data-league-section="sdhl"
      >
        <div class="section-head">
          <div>
            <h2 id="sdhl-title" class="vote-title">MÅNADENS SPELARE SDHL</h2>
            <p class="section-sub">Välj en spelare.</p>
          </div>
        </div>
        <div class="cards" id="sdhl-cards" role="list"></div>
      </section>

      <section
        class="vote"
        aria-labelledby="shl-title"
        data-league-section="shl"
      >
        <div class="section-head">
          <div>
            <h2 id="shl-title" class="vote-title">MÅNADENS SPELARE SHL</h2>
            <p class="section-sub">Välj en spelare.</p>
          </div>
        </div>
        <div class="cards" id="shl-cards" role="list"></div>
      </section>

      <section class="form" aria-labelledby="form-title">
        <div class="form-shell">
          <div class="section-head">
            <div>
              <p class="section-eyebrow">Dina uppgifter</p>
              <h2 id="form-title">Skicka in din röst</h2>
            </div>
            <div class="form-status" id="form-status">Minst en röst krävs.</div>
          </div>

          <form id="vote-form" novalidate>
            <div class="grid">
              <label>
                <span>Förnamn *</span>
                <input
                  type="text"
                  name="firstName"
                  autocomplete="given-name"
                  required
                />
              </label>
              <label>
                <span>Efternamn *</span>
                <input
                  type="text"
                  name="lastName"
                  autocomplete="family-name"
                  required
                />
              </label>
              <label>
                <span>E-post *</span>
                <input
                  type="email"
                  name="email"
                  autocomplete="email"
                  required
                />
              </label>
              <label>
                <span>Telefon</span>
                <input type="tel" name="phone" autocomplete="tel" />
              </label>
            </div>

            <label class="terms">
              <input type="checkbox" name="terms" required />
              <span>Jag accepterar villkoren.</span>
            </label>

            <label class="terms">
              <input type="checkbox" name="marketingConsent" />
              <span>Jag godkänner marknadsföringsutskick.</span>
            </label>

            <div class="submit-row">
              <button id="submit" type="submit" disabled>Skicka röst</button>
              <p class="hint">
                Du kan rösta på en SHL-spelare och en SDHL-spelare.
              </p>
            </div>
          </form>
        </div>
      </section>

      <section
        class="results"
        id="results"
        aria-labelledby="results-title"
        hidden
      >
        <div class="section-head">
          <div>
            <p class="section-eyebrow">Resultat</p>
            <h2 id="results-title">Ställning i procent</h2>
          </div>
        </div>
        <div class="results-grid" id="results-grid"></div>
      </section>

      <section class="admin" aria-labelledby="admin-title" hidden>
        <div class="section-head">
          <div>
            <p class="section-eyebrow">Admin</p>
            <h2 id="admin-title">Hantera lineup och sponsor</h2>
            <p class="section-sub">Ändringar sparas lokalt och syns direkt.</p>
          </div>
          <div class="admin-actions">
            <button class="ghost" id="export-data" type="button">
              Exportera JSON
            </button>
            <label class="ghost file">
              Importera JSON
              <input id="import-data" type="file" accept="application/json" />
            </label>
            <button class="ghost" id="logout-admin" type="button">
              Logga ut
            </button>
          </div>
        </div>

        <div class="admin-grid">
          <div class="panel">
            <h3>Sponsor</h3>
            <label>
              <span>Namn</span>
              <input id="sponsor-name" type="text" />
            </label>
            <label>
              <span>Logotyp-URL</span>
              <input id="sponsor-logo" type="url" />
            </label>
            <label>
              <span>Länk-URL</span>
              <input id="sponsor-link" type="url" />
            </label>
            <label>
              <span>Banner-URL</span>
              <input id="banner-url" type="url" />
            </label>
            <label class="toggle">
              <input id="voting-closed-toggle" type="checkbox" />
              <span>Stäng omröstningen</span>
            </label>
            <button class="primary" id="save-sponsor" type="button">
              Spara sponsor
            </button>
          </div>

          <div class="panel">
            <h3>Spelare</h3>
            <label>
              <span>League</span>
              <select id="league-select"></select>
            </label>
            <div id="player-list" class="player-list"></div>
          </div>

          <div class="panel">
            <h3>Ny / redigera spelare</h3>
            <form id="player-form">
              <input type="hidden" id="player-id" />
              <label>
                <span>Namn</span>
                <input id="player-name" type="text" required />
              </label>
              <label>
                <span>Nationalitet</span>
                <select id="player-country">
                  <option value="">Välj land</option>
                  <option value="SE">Sverige</option>
                  <option value="FI">Finland</option>
                  <option value="CA">Kanada</option>
                  <option value="US">USA</option>
                  <option value="CZ">Tjeckien</option>
                  <option value="SK">Slovakien</option>
                  <option value="CH">Schweiz</option>
                  <option value="IT">Italien</option>
                  <option value="JP">Japan</option>
                </select>
              </label>
              <label>
                <span>Position</span>
                <select id="player-position" required>
                  <option value="G">Målvakt (G)</option>
                  <option value="D">Back (D)</option>
                  <option value="C">Center (C)</option>
                  <option value="F">Forward (F)</option>
                </select>
              </label>
              <label>
                <span>Nummer</span>
                <input
                  id="player-number"
                  type="number"
                  min="0"
                  step="1"
                  required
                />
              </label>
            <label>
              <span>Bild-URL</span>
              <input id="player-image" type="url" required />
            </label>
            <label>
              <span>Stats (valfritt)</span>
              <input id="player-stats" type="text" placeholder="t.ex. 7 GP, 5 G, 4 A" />
            </label>
            <label class="toggle">
              <input id="player-active" type="checkbox" checked />
              <span>Aktiv denna månad</span>
            </label>
              <button class="primary" type="submit">Spara spelare</button>
              <button class="ghost" type="button" id="reset-player">
                Nollställ
              </button>
            </form>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer container">
      <p>© Månadens Spelare. Alla röster sparas enligt villkoren.</p>
      <div class="footer-actions">
        <button id="open-admin" class="ghost" type="button">Admin</button>
        <button id="logout-user" class="ghost" type="button" hidden>Logga ut</button>
      </div>
    </footer>

    <div class="modal-backdrop" id="login-modal" hidden>
      <section class="modal" role="dialog" aria-modal="true" aria-labelledby="login-title">
        <h2 id="login-title">Logga in</h2>
        <p class="section-sub">Vi skickar ett inloggningsmail (kod eller länk) till din e-post, eller fortsätt med Google.</p>

        <button class="primary" id="login-google" type="button">
          Fortsätt med Google
        </button>

        <p class="section-sub" style="text-align:center;">eller</p>

        <form id="email-form">
          <label>
            <span>E-post</span>
            <input id="login-email" type="email" required />
          </label>
          <button class="primary" type="submit">Skicka kod</button>
        </form>
        <form id="otp-form" hidden>
          <label>
            <span>Kod (om mailet innehåller kod)</span>
            <input id="otp-code" type="text" inputmode="numeric" required />
          </label>
          <button class="primary" type="submit">Verifiera</button>
        </form>
        <button class="ghost" id="close-login" type="button">Stäng</button>
      </section>
    </div>

    <div class="modal-backdrop" id="profile-modal" hidden>
      <section class="modal" role="dialog" aria-modal="true" aria-labelledby="profile-title">
        <h2 id="profile-title">Komplettera din profil</h2>
        <form id="profile-form">
          <label>
            <span>Förnamn *</span>
            <input id="profile-first-name" type="text" required />
          </label>
          <label>
            <span>Efternamn *</span>
            <input id="profile-last-name" type="text" required />
          </label>
          <label>
            <span>Födelseår *</span>
            <input id="profile-birth-year" type="number" min="1900" max="2100" required />
          </label>
          <label>
            <span>Postnummer *</span>
            <input id="profile-postal-code" type="text" required />
          </label>
          <label>
            <span>Telefon (valfri, ej verifierad)</span>
            <input id="profile-phone" type="tel" />
          </label>
          <label class="terms">
            <input id="profile-marketing" type="checkbox" />
            <span>Jag godkänner marknadsföringsutskick.</span>
          </label>
          <button class="primary" type="submit">Spara profil</button>
        </form>
      </section>
    </div>

    <div class="toast" id="toast" aria-live="polite"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
